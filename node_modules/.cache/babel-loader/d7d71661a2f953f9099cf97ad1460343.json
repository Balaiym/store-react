{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Acer\\\\Desktop\\\\e-commerce-react-app-master\\\\src\\\\components\\\\pages\\\\showcasePages\\\\CartPage\\\\CartPage.tsx\",\n    _s = $RefreshSig$();\n\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useNavigate } from 'react-router-dom';\nimport { NO_PRODUCTS_IN_CART } from '../../../../constants/messages';\nimport { PATHS } from '../../../../constants/routes';\nimport useForm from '../../../../hooks/useForm';\nimport { createOrder } from '../../../../store/CommonSlice';\nimport { clearCart, removeProductFromCart, setToLocalStorage, wishListHandler } from '../../../../store/UserSlice';\nimport { cartFormValidator } from '../../../../utils/validators';\nimport Section from '../../../layouts/showcaseLayouts/Section/Section';\nimport SectionBody from '../../../layouts/showcaseLayouts/Section/SectionBody/SectionBody';\nimport SectionHeader from '../../../layouts/showcaseLayouts/Section/SectionHeader/SectionHeader';\nimport Cart from '../../../showcase/Cart/Cart';\nimport CartForm from '../../../showcase/CartForm/CartForm';\nimport Placeholder from '../../../UI/Placeholder/Placeholder';\nimport classes from './CartPage.module.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst INIT_INPUT = {\n  name: '',\n  phone: '',\n  address: ''\n};\n\nconst CartPage = () => {\n  _s();\n\n  const dispatch = useDispatch();\n  const navigate = useNavigate();\n  const {\n    cart\n  } = useSelector(state => state.user);\n  const {\n    wishlist\n  } = useSelector(state => state.user);\n  const {\n    products\n  } = useSelector(state => state.product);\n  const {\n    error,\n    isLoading\n  } = useSelector(state => state.common);\n  const {\n    input,\n    handleChange,\n    errors,\n    submit\n  } = useForm(INIT_INPUT, handleSubmit, cartFormValidator);\n  const cartProducts = cart.map(cartItem => {\n    const product = products.find(product => product.id === cartItem.productId);\n    const isWished = wishlist.includes(cartItem.productId);\n    return { ...cartItem,\n      name: product.name,\n      image: product.image,\n      categoryUrl: product.category.url,\n      isWished\n    };\n  });\n  const price = cart.reduce((res, val) => res + val.totalPrice, 0);\n  const weight = +cart.reduce((res, val) => res + val.totalWeight, 0).toFixed(2);\n  const profit = cart.reduce((res, _ref) => {\n    let {\n      profit = 0\n    } = _ref;\n    return res + profit;\n  }, 0);\n  const quantity = cart.reduce((res, _ref2) => {\n    let {\n      quantity\n    } = _ref2;\n    return res + quantity;\n  }, 0);\n  const hasProducts = cart.length > 0;\n  const summaryProps = {\n    price,\n    weight,\n    profit,\n    quantity\n  };\n\n  const handleWishlist = _ref3 => {\n    let {\n      id,\n      isWished\n    } = _ref3;\n    dispatch(wishListHandler({\n      id,\n      isWished\n    }));\n  };\n\n  const handleRemoveCartItem = id => {\n    dispatch(removeProductFromCart(id));\n    dispatch(setToLocalStorage('cart'));\n  };\n\n  async function handleSubmit() {\n    const order = {\n      user: input,\n      cart: cart,\n      timestamp: Date.now(),\n      totalPrice: price,\n      totalWeight: weight,\n      totalDiscount: profit,\n      totalQuantity: quantity\n    };\n    await dispatch(createOrder(order));\n\n    if (!error.isError && !isLoading) {\n      navigate(`${PATHS.cart}/${PATHS.success}`);\n      dispatch(clearCart());\n      dispatch(setToLocalStorage('cart'));\n    }\n  }\n\n  return /*#__PURE__*/_jsxDEV(Section, {\n    children: /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(SectionHeader, {\n        title: 'Корзина'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(SectionBody, {\n        children: /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [!hasProducts && /*#__PURE__*/_jsxDEV(Placeholder, {\n            text: NO_PRODUCTS_IN_CART\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 30\n          }, this), hasProducts && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: classes['cart-page-body'],\n            children: [/*#__PURE__*/_jsxDEV(Cart, {\n              cart: cartProducts,\n              onRemove: handleRemoveCartItem,\n              onWish: handleWishlist,\n              ...summaryProps\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 99,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: classes.title,\n              children: \"\\u0412\\u0430\\u0448\\u0438 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0435\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 101,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(CartForm, {\n              onSubmit: submit,\n              value: input,\n              errors: errors,\n              onChange: handleChange,\n              isLoading: isLoading\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 102,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 98,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 89,\n    columnNumber: 5\n  }, this);\n};\n\n_s(CartPage, \"IvKDj5jAAIOlMwbQA7Xj6AVxyiw=\", false, function () {\n  return [useDispatch, useNavigate, useSelector, useSelector, useSelector, useSelector, useForm];\n});\n\n_c = CartPage;\nexport default CartPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"CartPage\");","map":{"version":3,"names":["useDispatch","useSelector","useNavigate","NO_PRODUCTS_IN_CART","PATHS","useForm","createOrder","clearCart","removeProductFromCart","setToLocalStorage","wishListHandler","cartFormValidator","Section","SectionBody","SectionHeader","Cart","CartForm","Placeholder","classes","INIT_INPUT","name","phone","address","CartPage","dispatch","navigate","cart","state","user","wishlist","products","product","error","isLoading","common","input","handleChange","errors","submit","handleSubmit","cartProducts","map","cartItem","find","id","productId","isWished","includes","image","categoryUrl","category","url","price","reduce","res","val","totalPrice","weight","totalWeight","toFixed","profit","quantity","hasProducts","length","summaryProps","handleWishlist","handleRemoveCartItem","order","timestamp","Date","now","totalDiscount","totalQuantity","isError","success","title"],"sources":["C:/Users/Acer/Desktop/e-commerce-react-app-master/src/components/pages/showcasePages/CartPage/CartPage.tsx"],"sourcesContent":["import { useDispatch, useSelector } from 'react-redux';\nimport { useNavigate } from 'react-router-dom';\nimport { NO_PRODUCTS_IN_CART } from '../../../../constants/messages';\nimport { PATHS } from '../../../../constants/routes';\nimport useForm from '../../../../hooks/useForm';\nimport { createOrder } from '../../../../store/CommonSlice';\nimport { AppDispatch, RootState } from '../../../../store/store';\nimport { clearCart, removeProductFromCart, setToLocalStorage, wishListHandler } from '../../../../store/UserSlice';\nimport { CartItem, Product, ProductCartItem } from '../../../../types/common';\nimport { cartFormValidator } from '../../../../utils/validators';\nimport Section from '../../../layouts/showcaseLayouts/Section/Section';\nimport SectionBody from '../../../layouts/showcaseLayouts/Section/SectionBody/SectionBody';\nimport SectionHeader from '../../../layouts/showcaseLayouts/Section/SectionHeader/SectionHeader';\nimport Cart from '../../../showcase/Cart/Cart';\nimport CartForm from '../../../showcase/CartForm/CartForm';\nimport Placeholder from '../../../UI/Placeholder/Placeholder';\nimport classes from './CartPage.module.css';\n\nconst INIT_INPUT = {\n  name: '',\n  phone: '',\n  address: '',\n};\n\nconst CartPage: React.FC = () => {\n  const dispatch = useDispatch<AppDispatch>();\n  const navigate = useNavigate();\n  const { cart } = useSelector((state: RootState) => state.user);\n  const { wishlist } = useSelector((state: RootState) => state.user);\n  const { products } = useSelector((state: RootState) => state.product);\n  const { error, isLoading } = useSelector((state: RootState) => state.common);\n  const { input, handleChange, errors, submit } = useForm(INIT_INPUT, handleSubmit, cartFormValidator);\n\n  const cartProducts: ProductCartItem[] = cart.map((cartItem) => {\n    const product = products.find((product) => product.id === cartItem.productId) as Product;\n    const isWished = wishlist.includes(cartItem.productId);\n\n    return {\n      ...cartItem,\n      name: product.name,\n      image: product.image,\n      categoryUrl: product.category.url,\n      isWished,\n    };\n  });\n\n  const price = cart.reduce((res, val) => res + val.totalPrice, 0);\n  const weight = +cart.reduce((res, val) => res + val.totalWeight, 0).toFixed(2);\n  const profit = cart.reduce((res, { profit = 0 }) => res + profit, 0);\n  const quantity = cart.reduce((res, { quantity }) => res + quantity, 0);\n  const hasProducts = cart.length > 0;\n  const summaryProps = {\n    price,\n    weight,\n    profit,\n    quantity,\n  };\n\n  const handleWishlist = ({ id, isWished }: { id: CartItem['productId']; isWished: boolean }) => {\n    dispatch(wishListHandler({ id, isWished }));\n  };\n\n  const handleRemoveCartItem = (id: CartItem['productId']) => {\n    dispatch(removeProductFromCart(id));\n    dispatch(setToLocalStorage('cart'));\n  };\n\n  async function handleSubmit() {\n    const order = {\n      user: input,\n      cart: cart,\n      timestamp: Date.now(),\n      totalPrice: price,\n      totalWeight: weight,\n      totalDiscount: profit,\n      totalQuantity: quantity,\n    };\n\n    await dispatch(createOrder(order));\n\n    if (!error.isError && !isLoading) {\n      navigate(`${PATHS.cart}/${PATHS.success}`);\n      dispatch(clearCart());\n      dispatch(setToLocalStorage('cart'));\n    }\n  }\n\n  return (\n    <Section>\n      <>\n        <SectionHeader title={'Корзина'} />\n\n        <SectionBody>\n          <>\n            {!hasProducts && <Placeholder text={NO_PRODUCTS_IN_CART} />}\n\n            {hasProducts && (\n              <div className={classes['cart-page-body']}>\n                <Cart cart={cartProducts} onRemove={handleRemoveCartItem} onWish={handleWishlist} {...summaryProps} />\n\n                <span className={classes.title}>Ваши данные</span>\n                <CartForm\n                  onSubmit={submit}\n                  value={input}\n                  errors={errors}\n                  onChange={handleChange}\n                  isLoading={isLoading}\n                />\n              </div>\n            )}\n          </>\n        </SectionBody>\n      </>\n    </Section>\n  );\n};\n\nexport default CartPage;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}