{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Acer\\\\Desktop\\\\e-commerce-react-app-master\\\\src\\\\components\\\\admin\\\\Categories\\\\Categories.tsx\",\n    _s = $RefreshSig$();\n\nimport { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { createCategory, deleteCategory, removeSelectedCategory, selectCategory, updateCategory } from '../../../store/CategorySlice';\nimport Placeholder from '../../UI/Placeholder/Placeholder';\nimport classes from './Categories.module.css';\nimport SettingsForm from '../SettingsForm/SettingsForm';\nimport useForm from '../../../hooks/useForm';\nimport SettingsList from '../SettingsList/SettingsList';\nimport { AlertType } from '../../../types/common';\nimport Card from '../../UI/Card/Card';\nimport IconButton from '../../UI/IconButton/IconButton';\nimport AddIcon from '../../UI/icons/AddIcon/AddIcon';\nimport { DELETE_CATEGORY_ALERT_MESSAGE, NO_CATEGORIES_MESSAGE } from '../../../constants/messages';\nimport { showAlert } from '../../../store/CommonSlice';\nimport AreaLoader from '../../UI/AreaLoader/AreaLoader';\nimport { updateAllProductsCategories } from '../../../store/ProductSlice';\nimport { categoryFormValidator } from '../../../utils/validators';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst INIT_INPUT = {\n  name: '',\n  description: '',\n  url: ''\n};\n\nconst Categories = () => {\n  _s();\n\n  const {\n    isLoading,\n    categories,\n    error\n  } = useSelector(state => state.category);\n  const {\n    products\n  } = useSelector(state => state.product);\n  const categoryToBeEdited = useSelector(state => state.category.selectedCategory);\n  const dispatch = useDispatch();\n  const [isFormOpen, setIsFormOpen] = useState(false);\n  const isPlaceholderVisible = !isLoading && !error.isError && !isFormOpen && categories.length === 0;\n  const {\n    input,\n    setInput,\n    handleChange,\n    errors,\n    submit,\n    resetForm\n  } = useForm(INIT_INPUT, handleSubmit, categoryFormValidator);\n  const modifedCategories = categories.map(category => {\n    const productCount = products.filter(product => product.category.id === category.id).length;\n    const discountedProductsCount = products.filter(product => product.category.id === category.id && product.discount).length;\n    return { ...category,\n      productsCount: productCount,\n      discountedProductsCount\n    };\n  });\n  useEffect(() => {\n    if (!categoryToBeEdited.id) return;\n    setInput(prev => ({ ...prev,\n      ...categoryToBeEdited\n    }));\n  }, [categoryToBeEdited, setInput]);\n\n  function handleSubmit() {\n    var _input$name, _input$description;\n\n    const name = (_input$name = input.name) === null || _input$name === void 0 ? void 0 : _input$name.trim();\n    const description = (_input$description = input.description) === null || _input$description === void 0 ? void 0 : _input$description.trim();\n    const url = input === null || input === void 0 ? void 0 : input.url.trim();\n\n    if (categoryToBeEdited.id) {\n      const updatedCategory = { ...categoryToBeEdited,\n        ...input\n      };\n      dispatch(updateAllProductsCategories(updatedCategory));\n      dispatch(updateCategory(updatedCategory));\n    } else {\n      const newCategory = {\n        name,\n        description,\n        url\n      };\n      dispatch(createCategory(newCategory));\n    }\n\n    closeForm();\n  }\n\n  const openForm = () => {\n    setIsFormOpen(true);\n  };\n\n  const closeForm = () => {\n    setIsFormOpen(false);\n    dispatch(removeSelectedCategory());\n    resetForm();\n  };\n\n  const deleteCategoryHendler = async id => {\n    const hasProducts = modifedCategories.some(category => category.id === id && category.productsCount > 0);\n\n    if (hasProducts) {\n      dispatch(showAlert({\n        type: AlertType.Error,\n        message: DELETE_CATEGORY_ALERT_MESSAGE\n      }));\n      return;\n    }\n\n    dispatch(deleteCategory(id));\n  };\n\n  const editCategoryHandler = id => {\n    dispatch(selectCategory(id));\n    openForm();\n  };\n\n  return /*#__PURE__*/_jsxDEV(Card, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: classes.category,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: classes.header,\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: classes.title,\n          children: \"\\u041A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u0438\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n          onClick: openForm,\n          isDisabled: isFormOpen || error.isError,\n          children: /*#__PURE__*/_jsxDEV(AddIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 124,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 9\n      }, this), isLoading && /*#__PURE__*/_jsxDEV(AreaLoader, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 23\n      }, this), !isLoading && error.isError && !isFormOpen && /*#__PURE__*/_jsxDEV(Placeholder, {\n        text: error.message\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 56\n      }, this), isPlaceholderVisible && /*#__PURE__*/_jsxDEV(Placeholder, {\n        text: NO_CATEGORIES_MESSAGE\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 34\n      }, this), isFormOpen && /*#__PURE__*/_jsxDEV(SettingsForm, {\n        onClose: closeForm,\n        onChange: handleChange,\n        onSubmit: submit,\n        errors: errors,\n        value: input,\n        labelName: 'Название категории',\n        labelURL: 'SEO URL',\n        namePlaceholder: 'Укажите название категории',\n        descriptionPlaceholder: 'Описание категории'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 11\n      }, this), !isFormOpen && (categories === null || categories === void 0 ? void 0 : categories.length) > 0 && /*#__PURE__*/_jsxDEV(SettingsList, {\n        items: modifedCategories,\n        onEdit: editCategoryHandler,\n        onDelete: deleteCategoryHendler\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 119,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Categories, \"KhpTfOq6U3yFKrRasIxJjDP5r/g=\", false, function () {\n  return [useSelector, useSelector, useSelector, useDispatch, useForm];\n});\n\n_c = Categories;\nexport default Categories;\n\nvar _c;\n\n$RefreshReg$(_c, \"Categories\");","map":{"version":3,"names":["useEffect","useState","useDispatch","useSelector","createCategory","deleteCategory","removeSelectedCategory","selectCategory","updateCategory","Placeholder","classes","SettingsForm","useForm","SettingsList","AlertType","Card","IconButton","AddIcon","DELETE_CATEGORY_ALERT_MESSAGE","NO_CATEGORIES_MESSAGE","showAlert","AreaLoader","updateAllProductsCategories","categoryFormValidator","INIT_INPUT","name","description","url","Categories","isLoading","categories","error","state","category","products","product","categoryToBeEdited","selectedCategory","dispatch","isFormOpen","setIsFormOpen","isPlaceholderVisible","isError","length","input","setInput","handleChange","errors","submit","resetForm","handleSubmit","modifedCategories","map","productCount","filter","id","discountedProductsCount","discount","productsCount","prev","trim","updatedCategory","newCategory","closeForm","openForm","deleteCategoryHendler","hasProducts","some","type","Error","message","editCategoryHandler","header","title"],"sources":["C:/Users/Acer/Desktop/e-commerce-react-app-master/src/components/admin/Categories/Categories.tsx"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport {\n  createCategory,\n  deleteCategory,\n  removeSelectedCategory,\n  selectCategory,\n  updateCategory,\n} from '../../../store/CategorySlice';\nimport { AppDispatch, RootState } from '../../../store/store';\nimport Placeholder from '../../UI/Placeholder/Placeholder';\nimport classes from './Categories.module.css';\nimport SettingsForm from '../SettingsForm/SettingsForm';\nimport useForm from '../../../hooks/useForm';\nimport SettingsList from '../SettingsList/SettingsList';\nimport { AlertType, Category } from '../../../types/common';\nimport Card from '../../UI/Card/Card';\nimport IconButton from '../../UI/IconButton/IconButton';\nimport AddIcon from '../../UI/icons/AddIcon/AddIcon';\nimport { DELETE_CATEGORY_ALERT_MESSAGE, NO_CATEGORIES_MESSAGE } from '../../../constants/messages';\nimport { showAlert } from '../../../store/CommonSlice';\nimport AreaLoader from '../../UI/AreaLoader/AreaLoader';\nimport { updateAllProductsCategories } from '../../../store/ProductSlice';\nimport { categoryFormValidator } from '../../../utils/validators';\n\nconst INIT_INPUT = {\n  name: '',\n  description: '',\n  url: '',\n};\n\nconst Categories: React.FC = () => {\n  const { isLoading, categories, error } = useSelector((state: RootState) => state.category);\n  const { products } = useSelector((state: RootState) => state.product);\n  const categoryToBeEdited = useSelector((state: RootState) => state.category.selectedCategory);\n  const dispatch = useDispatch<AppDispatch>();\n  const [isFormOpen, setIsFormOpen] = useState(false);\n  const isPlaceholderVisible = !isLoading && !error.isError && !isFormOpen && categories.length === 0;\n  const { input, setInput, handleChange, errors, submit, resetForm } = useForm(\n    INIT_INPUT,\n    handleSubmit,\n    categoryFormValidator\n  );\n\n  const modifedCategories = categories.map((category) => {\n    const productCount = products.filter((product) => product.category.id === category.id).length;\n    const discountedProductsCount = products.filter(\n      (product) => product.category.id === category.id && product.discount\n    ).length;\n    return {\n      ...category,\n      productsCount: productCount,\n      discountedProductsCount,\n    };\n  });\n\n  useEffect(() => {\n    if (!categoryToBeEdited.id) return;\n\n    setInput((prev) => ({\n      ...prev,\n      ...categoryToBeEdited,\n    }));\n  }, [categoryToBeEdited, setInput]);\n\n  function handleSubmit() {\n    const name = input.name?.trim();\n    const description = input.description?.trim();\n    const url = input?.url.trim();\n\n    if (categoryToBeEdited.id) {\n      const updatedCategory = {\n        ...categoryToBeEdited,\n        ...input,\n      };\n\n      dispatch(updateAllProductsCategories(updatedCategory));\n      dispatch(updateCategory(updatedCategory));\n    } else {\n      const newCategory = {\n        name,\n        description,\n        url,\n      };\n\n      dispatch(createCategory(newCategory));\n    }\n\n    closeForm();\n  }\n\n  const openForm = () => {\n    setIsFormOpen(true);\n  };\n\n  const closeForm = () => {\n    setIsFormOpen(false);\n    dispatch(removeSelectedCategory());\n    resetForm();\n  };\n\n  const deleteCategoryHendler = async (id: Category['id']) => {\n    const hasProducts = modifedCategories.some((category) => category.id === id && category.productsCount > 0);\n\n    if (hasProducts) {\n      dispatch(showAlert({ type: AlertType.Error, message: DELETE_CATEGORY_ALERT_MESSAGE }));\n      return;\n    }\n\n    dispatch(deleteCategory(id));\n  };\n\n  const editCategoryHandler = (id: Category['id']) => {\n    dispatch(selectCategory(id));\n    openForm();\n  };\n\n  return (\n    <Card>\n      <div className={classes.category}>\n        <div className={classes.header}>\n          <h3 className={classes.title}>Категории</h3>\n          <IconButton onClick={openForm} isDisabled={isFormOpen || error.isError}>\n            <AddIcon />\n          </IconButton>\n        </div>\n\n        {isLoading && <AreaLoader />}\n\n        {!isLoading && error.isError && !isFormOpen && <Placeholder text={error.message} />}\n\n        {isPlaceholderVisible && <Placeholder text={NO_CATEGORIES_MESSAGE} />}\n\n        {isFormOpen && (\n          <SettingsForm\n            onClose={closeForm}\n            onChange={handleChange}\n            onSubmit={submit}\n            errors={errors}\n            value={input}\n            labelName={'Название категории'}\n            labelURL={'SEO URL'}\n            namePlaceholder={'Укажите название категории'}\n            descriptionPlaceholder={'Описание категории'}\n          />\n        )}\n\n        {!isFormOpen && categories?.length > 0 && (\n          <SettingsList items={modifedCategories} onEdit={editCategoryHandler} onDelete={deleteCategoryHendler} />\n        )}\n      </div>\n    </Card>\n  );\n};\n\nexport default Categories;\n"],"mappings":";;;AAAA,SAASA,SAAT,EAAoBC,QAApB,QAAoC,OAApC;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,aAAzC;AACA,SACEC,cADF,EAEEC,cAFF,EAGEC,sBAHF,EAIEC,cAJF,EAKEC,cALF,QAMO,8BANP;AAQA,OAAOC,WAAP,MAAwB,kCAAxB;AACA,OAAOC,OAAP,MAAoB,yBAApB;AACA,OAAOC,YAAP,MAAyB,8BAAzB;AACA,OAAOC,OAAP,MAAoB,wBAApB;AACA,OAAOC,YAAP,MAAyB,8BAAzB;AACA,SAASC,SAAT,QAAoC,uBAApC;AACA,OAAOC,IAAP,MAAiB,oBAAjB;AACA,OAAOC,UAAP,MAAuB,gCAAvB;AACA,OAAOC,OAAP,MAAoB,gCAApB;AACA,SAASC,6BAAT,EAAwCC,qBAAxC,QAAqE,6BAArE;AACA,SAASC,SAAT,QAA0B,4BAA1B;AACA,OAAOC,UAAP,MAAuB,gCAAvB;AACA,SAASC,2BAAT,QAA4C,6BAA5C;AACA,SAASC,qBAAT,QAAsC,2BAAtC;;AAEA,MAAMC,UAAU,GAAG;EACjBC,IAAI,EAAE,EADW;EAEjBC,WAAW,EAAE,EAFI;EAGjBC,GAAG,EAAE;AAHY,CAAnB;;AAMA,MAAMC,UAAoB,GAAG,MAAM;EAAA;;EACjC,MAAM;IAAEC,SAAF;IAAaC,UAAb;IAAyBC;EAAzB,IAAmC5B,WAAW,CAAE6B,KAAD,IAAsBA,KAAK,CAACC,QAA7B,CAApD;EACA,MAAM;IAAEC;EAAF,IAAe/B,WAAW,CAAE6B,KAAD,IAAsBA,KAAK,CAACG,OAA7B,CAAhC;EACA,MAAMC,kBAAkB,GAAGjC,WAAW,CAAE6B,KAAD,IAAsBA,KAAK,CAACC,QAAN,CAAeI,gBAAtC,CAAtC;EACA,MAAMC,QAAQ,GAAGpC,WAAW,EAA5B;EACA,MAAM,CAACqC,UAAD,EAAaC,aAAb,IAA8BvC,QAAQ,CAAC,KAAD,CAA5C;EACA,MAAMwC,oBAAoB,GAAG,CAACZ,SAAD,IAAc,CAACE,KAAK,CAACW,OAArB,IAAgC,CAACH,UAAjC,IAA+CT,UAAU,CAACa,MAAX,KAAsB,CAAlG;EACA,MAAM;IAAEC,KAAF;IAASC,QAAT;IAAmBC,YAAnB;IAAiCC,MAAjC;IAAyCC,MAAzC;IAAiDC;EAAjD,IAA+DrC,OAAO,CAC1EY,UAD0E,EAE1E0B,YAF0E,EAG1E3B,qBAH0E,CAA5E;EAMA,MAAM4B,iBAAiB,GAAGrB,UAAU,CAACsB,GAAX,CAAgBnB,QAAD,IAAc;IACrD,MAAMoB,YAAY,GAAGnB,QAAQ,CAACoB,MAAT,CAAiBnB,OAAD,IAAaA,OAAO,CAACF,QAAR,CAAiBsB,EAAjB,KAAwBtB,QAAQ,CAACsB,EAA9D,EAAkEZ,MAAvF;IACA,MAAMa,uBAAuB,GAAGtB,QAAQ,CAACoB,MAAT,CAC7BnB,OAAD,IAAaA,OAAO,CAACF,QAAR,CAAiBsB,EAAjB,KAAwBtB,QAAQ,CAACsB,EAAjC,IAAuCpB,OAAO,CAACsB,QAD9B,EAE9Bd,MAFF;IAGA,OAAO,EACL,GAAGV,QADE;MAELyB,aAAa,EAAEL,YAFV;MAGLG;IAHK,CAAP;EAKD,CAVyB,CAA1B;EAYAxD,SAAS,CAAC,MAAM;IACd,IAAI,CAACoC,kBAAkB,CAACmB,EAAxB,EAA4B;IAE5BV,QAAQ,CAAEc,IAAD,KAAW,EAClB,GAAGA,IADe;MAElB,GAAGvB;IAFe,CAAX,CAAD,CAAR;EAID,CAPQ,EAON,CAACA,kBAAD,EAAqBS,QAArB,CAPM,CAAT;;EASA,SAASK,YAAT,GAAwB;IAAA;;IACtB,MAAMzB,IAAI,kBAAGmB,KAAK,CAACnB,IAAT,gDAAG,YAAYmC,IAAZ,EAAb;IACA,MAAMlC,WAAW,yBAAGkB,KAAK,CAAClB,WAAT,uDAAG,mBAAmBkC,IAAnB,EAApB;IACA,MAAMjC,GAAG,GAAGiB,KAAH,aAAGA,KAAH,uBAAGA,KAAK,CAAEjB,GAAP,CAAWiC,IAAX,EAAZ;;IAEA,IAAIxB,kBAAkB,CAACmB,EAAvB,EAA2B;MACzB,MAAMM,eAAe,GAAG,EACtB,GAAGzB,kBADmB;QAEtB,GAAGQ;MAFmB,CAAxB;MAKAN,QAAQ,CAAChB,2BAA2B,CAACuC,eAAD,CAA5B,CAAR;MACAvB,QAAQ,CAAC9B,cAAc,CAACqD,eAAD,CAAf,CAAR;IACD,CARD,MAQO;MACL,MAAMC,WAAW,GAAG;QAClBrC,IADkB;QAElBC,WAFkB;QAGlBC;MAHkB,CAApB;MAMAW,QAAQ,CAAClC,cAAc,CAAC0D,WAAD,CAAf,CAAR;IACD;;IAEDC,SAAS;EACV;;EAED,MAAMC,QAAQ,GAAG,MAAM;IACrBxB,aAAa,CAAC,IAAD,CAAb;EACD,CAFD;;EAIA,MAAMuB,SAAS,GAAG,MAAM;IACtBvB,aAAa,CAAC,KAAD,CAAb;IACAF,QAAQ,CAAChC,sBAAsB,EAAvB,CAAR;IACA2C,SAAS;EACV,CAJD;;EAMA,MAAMgB,qBAAqB,GAAG,MAAOV,EAAP,IAA8B;IAC1D,MAAMW,WAAW,GAAGf,iBAAiB,CAACgB,IAAlB,CAAwBlC,QAAD,IAAcA,QAAQ,CAACsB,EAAT,KAAgBA,EAAhB,IAAsBtB,QAAQ,CAACyB,aAAT,GAAyB,CAApF,CAApB;;IAEA,IAAIQ,WAAJ,EAAiB;MACf5B,QAAQ,CAAClB,SAAS,CAAC;QAAEgD,IAAI,EAAEtD,SAAS,CAACuD,KAAlB;QAAyBC,OAAO,EAAEpD;MAAlC,CAAD,CAAV,CAAR;MACA;IACD;;IAEDoB,QAAQ,CAACjC,cAAc,CAACkD,EAAD,CAAf,CAAR;EACD,CATD;;EAWA,MAAMgB,mBAAmB,GAAIhB,EAAD,IAAwB;IAClDjB,QAAQ,CAAC/B,cAAc,CAACgD,EAAD,CAAf,CAAR;IACAS,QAAQ;EACT,CAHD;;EAKA,oBACE,QAAC,IAAD;IAAA,uBACE;MAAK,SAAS,EAAEtD,OAAO,CAACuB,QAAxB;MAAA,wBACE;QAAK,SAAS,EAAEvB,OAAO,CAAC8D,MAAxB;QAAA,wBACE;UAAI,SAAS,EAAE9D,OAAO,CAAC+D,KAAvB;UAAA;QAAA;UAAA;UAAA;UAAA;QAAA,QADF,eAEE,QAAC,UAAD;UAAY,OAAO,EAAET,QAArB;UAA+B,UAAU,EAAEzB,UAAU,IAAIR,KAAK,CAACW,OAA/D;UAAA,uBACE,QAAC,OAAD;YAAA;YAAA;YAAA;UAAA;QADF;UAAA;UAAA;UAAA;QAAA,QAFF;MAAA;QAAA;QAAA;QAAA;MAAA,QADF,EAQGb,SAAS,iBAAI,QAAC,UAAD;QAAA;QAAA;QAAA;MAAA,QARhB,EAUG,CAACA,SAAD,IAAcE,KAAK,CAACW,OAApB,IAA+B,CAACH,UAAhC,iBAA8C,QAAC,WAAD;QAAa,IAAI,EAAER,KAAK,CAACuC;MAAzB;QAAA;QAAA;QAAA;MAAA,QAVjD,EAYG7B,oBAAoB,iBAAI,QAAC,WAAD;QAAa,IAAI,EAAEtB;MAAnB;QAAA;QAAA;QAAA;MAAA,QAZ3B,EAcGoB,UAAU,iBACT,QAAC,YAAD;QACE,OAAO,EAAEwB,SADX;QAEE,QAAQ,EAAEjB,YAFZ;QAGE,QAAQ,EAAEE,MAHZ;QAIE,MAAM,EAAED,MAJV;QAKE,KAAK,EAAEH,KALT;QAME,SAAS,EAAE,oBANb;QAOE,QAAQ,EAAE,SAPZ;QAQE,eAAe,EAAE,4BARnB;QASE,sBAAsB,EAAE;MAT1B;QAAA;QAAA;QAAA;MAAA,QAfJ,EA4BG,CAACL,UAAD,IAAe,CAAAT,UAAU,SAAV,IAAAA,UAAU,WAAV,YAAAA,UAAU,CAAEa,MAAZ,IAAqB,CAApC,iBACC,QAAC,YAAD;QAAc,KAAK,EAAEQ,iBAArB;QAAwC,MAAM,EAAEoB,mBAAhD;QAAqE,QAAQ,EAAEN;MAA/E;QAAA;QAAA;QAAA;MAAA,QA7BJ;IAAA;MAAA;MAAA;MAAA;IAAA;EADF;IAAA;IAAA;IAAA;EAAA,QADF;AAoCD,CA1HD;;GAAMrC,U;UACqCzB,W,EACpBA,W,EACMA,W,EACVD,W,EAGoDU,O;;;KAPjEgB,U;AA4HN,eAAeA,UAAf"},"metadata":{},"sourceType":"module"}